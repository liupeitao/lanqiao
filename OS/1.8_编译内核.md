#### 04.1 编译内核

2022年4月5日09:31:03



“编译内核” 比 “编写内核” 要简单得多。

首先要进入 linux-0.11 目录，然后执行 make 命令：

```bash
$ cd ./linux-0.11/
$ make all
```

因为 `all` 是最常用的参数，所以可以省略，只用 `make`，效果一样。

在多处理器的系统上，可以用 -j 参数进行并行编译，加快速度。例如双 CPU 的系统可以：

```bash
$ make -j 2
```

make 命令会显示很多很多的信息，你可以尽量去看懂，也可以装作没看见。只要最后几行中没有 “error” 就说明编译成功。

最后生成的目标文件是一个软盘镜像文件—— `linux-0.11/Image`（下面的图中给出了详细的信息）。如果将此镜像文件写到一张 1.44MB 的软盘上，就可以启动一台真正的计算机。

![图片描述](1.8_编译内核.assets/uid977658-20190618-1560851871452.png)

linux-0.11 目录下是全部的源代码，很多实验内容都是要靠修改这些代码来完成。修改后需要重新编译内核，还是执行命令：`make all`。

make 命令会自动跳过未被修改的文件，链接时直接使用上次编译生成的目标文件，从而节约编译时间。但如果重新编译后，你的修改貌似没有生效，可以试试先 `make clean` ，再 `make all`（或者一行命令：`make clean && make all`。`make clean` 是删除上一次编译生成的所有中间文件和目标文件，确保是在全新的状态下编译整个工程。